import numpy as np
import matplotlib.pyplot as plt
import circle_fit as cf

def cartesian_to_polar(points):
  """Converts an array of 2D Cartesian points to polar coordinates.

  Args:
    points: A NumPy array of shape (n, 2), where n is the number of points.

  Returns:
    A NumPy array of shape (n, 2), where the first column is the radius and the second column is the angle in radians.
  """

  x, y = points[:, 0], points[:, 1]
  r = np.sqrt(x**2 + y**2)
  theta = np.arctan2(y, x)
  return np.column_stack((r, theta))
    
n_samples = 500

nist_cir_data = np.array([[-37.8542, 1.94727, 2.6954],
[-37.58897, 1.88988, 2.6954],
[-37.40469, 1.86389, 2.6954],
[-37.54657, 1.48975, 2.6954],
[-37.19397, 1.5742, 2.6954],
[-37.00018, 1.52233, 2.6954],
[-37.07928, 1.15805, 2.6954],
[-36.78475, 1.25434, 2.6954],
[-36.82794, 0.97102, 2.6954],
[-36.48364, 0.98987, 2.6954],
[-36.24921, 0.98224, 2.6954],
[-36.38725, 0.54197, 2.6954],
[-36.23209, 0.46831, 2.6954],
[-35.94027, 0.5168, 2.6954],
[-35.70161, 0.51432, 2.6954],
[-35.80588, 0.09886, 2.6954],
[-35.48517, 0.23579, 2.6954],
[-35.36536, 0.12248, 2.6954],
[-35.26585, -0.0388, 2.6954],
[-34.96465, 0.09345, 2.6954],
[-34.89847, -0.18901, 2.6954],
[-34.86548, -0.53563, 2.6954],
[-34.68071, -0.42212, 2.6954],
[-34.44997, -0.54822, 2.6954],
[-34.32476, -0.58787, 2.6954],
[-34.0828, -0.63745, 2.6954],
[-33.89533, -0.64344, 2.6954],
[-33.90506, -0.98865, 2.6954],
[-33.90695, -1.30695, 2.6954],
[-33.73923, -1.40706, 2.6954],
[-33.32835, -1.12787, 2.6954],
[-33.1506, -1.1479, 2.6954],
[-33.01654, -1.22587, 2.6954],
[-32.95003, -1.48178, 2.6954],
[-32.78517, -1.62758, 2.6954],
[-32.52341, -1.49466, 2.6954],
[-32.53622, -1.96348, 2.6954],
[-32.28034, -1.8074, 2.6954],
[-32.29555, -2.20215, 2.6954],
[-32.01416, -2.06952, 2.6954],
[-31.82698, -2.16278, 2.6954],
[-31.73445, -2.3365, 2.6954],
[-31.53253, -2.31876, 2.6954],
[-31.32896, -2.33244, 2.6954],
[-31.12332, -2.37907, 2.6954],
[-31.0933, -2.72984, 2.6954],
[-30.79198, -2.50331, 2.6954],
[-30.70088, -2.65783, 2.6954],
[-30.65816, -2.95543, 2.6954],
[-30.33294, -2.70569, 2.6954],
[-30.15514, -2.80156, 2.6954],
[-29.98748, -2.88123, 2.6954],
[-29.9146, -3.17113, 2.6954],
[-29.71693, -3.16075, 2.6954],
[-29.58899, -3.23934, 2.6954],
[-29.35059, -3.2969, 2.6954],
[-29.22255, -3.4496, 2.6954],
[-29.16246, -3.60551, 2.6954],
[-28.84927, -3.4423, 2.6954],
[-28.74377, -3.73398, 2.6954],
[-28.51492, -3.70852, 2.6954],
[-28.33995, -3.6943, 2.6954],
[-28.18017, -3.68529, 2.6954],
[-27.96923, -3.72787, 2.6954],
[-27.92217, -4.07808, 2.6954],
[-27.62104, -3.77041, 2.6954],
[-27.62531, -4.26556, 2.6954],
[-27.25452, -3.83936, 2.6954],
[-27.20122, -4.27652, 2.6954],
[-27.0374, -4.22096, 2.6954],
[-26.72695, -3.9724, 2.6954],
[-26.57394, -4.02114, 2.6954],
[-26.50773, -4.48666, 2.6954],
[-26.19798, -4.21668, 2.6954],
[-26.12512, -4.4042, 2.6954],
[-25.89375, -4.30562, 2.6954],
[-25.7199, -4.32215, 2.6954],
[-25.64268, -4.75042, 2.6954],
[-25.37149, -4.43433, 2.6954],
[-25.21085, -4.35692, 2.6954],
[-25.06462, -4.72192, 2.6954],
[-24.88036, -4.50221, 2.6954],
[-24.67389, -4.75544, 2.6954],
[-24.57363, -4.96182, 2.6954],
[-24.3835, -5.03767, 2.6954],
[-24.14689, -4.78337, 2.6954],
[-24.0146, -4.99425, 2.6954],
[-23.8514, -5.18314, 2.6954],
[-23.56931, -4.71068, 2.6954],
[-23.4925, -5.02922, 2.6954],
[-23.29964, -4.96341, 2.6954],
[-23.07176, -5.01766, 2.6954],
[-22.8913, -5.29753, 2.6954],
[-22.7218, -5.00778, 2.6954],
[-22.54225, -4.98807, 2.6954],
[-22.38065, -5.16108, 2.6954],
[-22.14858, -5.0746, 2.6954],
[-22.0507, -5.35625, 2.6954],
[-21.84989, -5.46464, 2.6954],
[-21.69893, -5.48884, 2.6954],
[-21.50466, -5.22397, 2.6954],
[-21.25848, -5.19547, 2.6954],
[-21.10176, -5.11473, 2.6954],
[-20.95506, -5.52511, 2.6954],
[-20.71586, -5.24515, 2.6954],
[-20.58004, -5.34917, 2.6954],
[-20.3809, -5.14646, 2.6954],
[-20.21413, -5.18603, 2.6954],
[-19.95904, -5.1767, 2.6954],
[-19.79424, -5.65261, 2.6954],
[-19.66336, -5.10619, 2.6954],
[-19.48105, -5.61969, 2.6954],
[-19.27754, -5.19302, 2.6954],
[-19.10153, -5.48969, 2.6954],
[-18.91209, -5.64348, 2.6954],
[-18.74852, -5.2085, 2.6954],
[-18.56682, -5.55356, 2.6954],
[-18.40054, -5.30175, 2.6954],
[-18.20079, -5.58949, 2.6954],
[-17.99361, -5.60221, 2.6954],
[-17.84044, -5.34374, 2.6954],
[-17.65064, -5.56322, 2.6954],
[-17.49352, -5.13811, 2.6954],
[-17.25381, -5.54983, 2.6954],
[-17.11511, -5.45764, 2.6954],
[-16.93388, -5.25844, 2.6954],
[-16.77096, -5.1302, 2.6954],
[-16.56586, -5.19889, 2.6954],
[-16.36595, -5.61585, 2.6954],
[-16.20395, -5.11801, 2.6954],
[-15.99513, -5.50775, 2.6954],
[-15.86288, -5.56603, 2.6954],
[-15.66119, -5.18766, 2.6954],
[-15.45772, -5.07597, 2.6954],
[-15.34884, -5.22085, 2.6954],
[-15.11098, -4.99589, 2.6954],
[-14.9869, -5.06531, 2.6954],
[-14.74444, -5.32393, 2.6954],
[-14.53963, -5.46995, 2.6954],
[-14.32389, -5.39686, 2.6954],
[-14.20332, -5.16567, 2.6954],
[-13.97246, -5.31445, 2.6954],
[-13.84589, -5.34296, 2.6954],
[-13.64285, -5.19185, 2.6954],
[-13.55387, -4.73014, 2.6954],
[-13.33269, -4.91355, 2.6954],
[-13.11383, -5.08386, 2.6954],
[-12.96737, -4.87898, 2.6954],
[-12.74999, -5.13455, 2.6954],
[-12.62602, -4.73729, 2.6954],
[-12.50452, -4.67084, 2.6954],
[-12.27001, -4.63853, 2.6954],
[-12.11556, -4.42056, 2.6954],
[-11.97239, -4.54118, 2.6954],
[-11.72314, -4.55026, 2.6954],
[-11.55783, -4.58693, 2.6954],
[-11.33432, -4.62624, 2.6954],
[-11.13842, -4.6212, 2.6954],
[-10.94379, -4.7409, 2.6954],
[-10.87307, -4.13824, 2.6954],
[-10.68918, -4.3733, 2.6954],
[-10.46333, -4.52587, 2.6954],
[-10.36146, -4.096, 2.6954],
[-10.12685, -4.13876, 2.6954],
[-9.87363, -4.36652, 2.6954],
[-9.80715, -4.21472, 2.6954],
[-9.61908, -4.13735, 2.6954],
[-9.37188, -4.16839, 2.6954],
[-9.26289, -3.97754, 2.6954],
[-9.06989, -3.95748, 2.6954],
[-8.97204, -3.66792, 2.6954],
[-8.66657, -3.92863, 2.6954],
[-8.63993, -3.46867, 2.6954],
[-8.4676, -3.51935, 2.6954],
[-8.17875, -3.69254, 2.6954],
[-8.10416, -3.51723, 2.6954],
[-7.97189, -3.2768, 2.6954],
[-7.74795, -3.26614, 2.6954],
[-7.56937, -3.30887, 2.6954],
[-7.34412, -3.3209, 2.6954],
[-7.18087, -3.32471, 2.6954],
[-7.12666, -2.92343, 2.6954],
[-6.8805, -3.07555, 2.6954],
[-6.72534, -2.96729, 2.6954],
[-6.47907, -3.17591, 2.6954],
[-6.4943, -2.65754, 2.6954],
[-6.17563, -2.90865, 2.6954],
[-6.11296, -2.601, 2.6954],
[-5.95338, -2.55642, 2.6954],
[-5.75482, -2.48342, 2.6954],
[-5.62691, -2.38691, 2.6954],
[-5.42179, -2.31226, 2.6954],
[-5.17782, -2.41502, 2.6954],
[-5.09443, -2.10808, 2.6954],
[-4.93696, -2.07278, 2.6954],
[-4.90484, -1.76174, 2.6954],
[-4.62638, -1.77313, 2.6954],
[-4.54943, -1.64622, 2.6954],
[-4.38112, -1.62499, 2.6954],
[-4.28002, -1.39576, 2.6954],
[-4.06802, -1.37891, 2.6954],
[-3.85284, -1.36721, 2.6954],
[-3.54542, -1.57082, 2.6954],
[-3.4066, -1.4057, 2.6954],
[-3.32674, -1.27862, 2.6954],
[-3.23725, -1.03399, 2.6954],
[-3.14691, -0.85603, 2.6954],
[-2.93798, -0.83438, 2.6954],
[-2.81187, -0.71604, 2.6954],
[-2.72932, -0.44653, 2.6954],
[-2.51581, -0.53537, 2.6954],
[-2.30685, -0.49969, 2.6954],
[-2.23796, -0.18751, 2.6954],
[-1.9574, -0.38117, 2.6954],
[-1.88814, -0.11743, 2.6954],
[-1.56595, -0.301, 2.6954],
[-1.62132, 0.14669, 2.6954],
[-1.54351, 0.34883, 2.6954],
[-1.32749, 0.32944, 2.6954],
[-0.98308, 0.25832, 2.6954],
[-1.12222, 0.71119, 2.6954],
[-0.89244, 0.69835, 2.6954],
[-0.64143, 0.69512, 2.6954],
[-0.60178, 0.90307, 2.6954],
[-0.47029, 1.01585, 2.6954],
[-0.43434, 1.2349, 2.6954],
[-0.17733, 1.23361, 2.6954],
[-0.07842, 1.39041, 2.6954],
[0.30197, 1.27154, 2.6954],
[0.33127, 1.50287, 2.6954],
[0.39671, 1.67559, 2.6954],
[0.72226, 1.61975, 2.6954],
[0.85757, 1.78344, 2.6954],
[0.79516, 2.04351, 2.6954],
[0.96201, 2.12186, 2.6954],
[1.30235, 2.08241, 2.6954],
[1.37888, 2.16561, 2.6954],
[1.35561, 2.53848, 2.6954],
[1.61696, 2.47622, 2.6954],
[1.7001, 2.6712, 2.6954],
[1.60515, 3.03066, 2.6954],
[1.76284, 3.15023, 2.6954],
[1.9956, 3.08717, 2.6954],
[2.01852, 3.37002, 2.6954],
[2.45635, 3.22708, 2.6954],
[2.35827, 3.58909, 2.6954],
[2.38984, 3.70489, 2.6954],
[2.83319, 3.60166, 2.6954],
[2.96478, 3.73831, 2.6954],
[2.76767, 4.16681, 2.6954],
[2.99393, 4.20861, 2.6954],
[3.11186, 4.34645, 2.6954],
[3.40229, 4.32457, 2.6954],
[3.45366, 4.46839, 2.6954],
[3.45743, 4.76888, 2.6954],
[3.7735, 4.7432, 2.6954],
[3.53155, 5.14688, 2.6954],
[4.07694, 5.00585, 2.6954],
[3.82086, 5.38438, 2.6954],
[4.09235, 5.35699, 2.6954],
[4.13137, 5.59187, 2.6954],
[4.21882, 5.76303, 2.6954],
[4.58515, 5.69234, 2.6954],
[4.65298, 5.91042, 2.6954],
[4.76117, 6.06914, 2.6954],
[4.54332, 6.40478, 2.6954],
[4.92909, 6.45248, 2.6954],
[4.78812, 6.72065, 2.6954],
[5.05026, 6.74235, 2.6954],
[5.24226, 6.82952, 2.6954],
[5.39853, 6.91266, 2.6954],
[5.14028, 7.35794, 2.6954],
[5.62079, 7.17712, 2.6954],
[5.43103, 7.58962, 2.6954],
[5.68189, 7.57225, 2.6954],
[5.94619, 7.68589, 2.6954],
[5.73818, 8.07012, 2.6954],
[5.91363, 8.12776, 2.6954],
[5.97114, 8.3207, 2.6954],
[6.3687, 8.30597, 2.6954],
[6.29522, 8.52781, 2.6954],
[6.4003, 8.69335, 2.6954],
[6.3773, 8.87799, 2.6954],
[6.44847, 9.03591, 2.6954],
[6.47944, 9.2657, 2.6954],
[6.73967, 9.33934, 2.6954],
[6.78685, 9.45026, 2.6954],
[6.88577, 9.65756, 2.6954],
[6.77129, 9.92423, 2.6954],
[7.23786, 9.85305, 2.6954],
[7.34746, 10.0341, 2.6954],
[7.12593, 10.34639, 2.6954],
[7.12398, 10.57348, 2.6954],
[7.59323, 10.52929, 2.6954],
[7.57768, 10.72061, 2.6954],
[7.70877, 10.86544, 2.6954],
[7.49463, 11.21668, 2.6954],
[7.55917, 11.35553, 2.6954],
[7.99836, 11.35304, 2.6954],
[7.71754, 11.66444, 2.6954],
[7.83727, 11.81768, 2.6954],
[7.92601, 11.98775, 2.6954],
[7.98696, 12.15084, 2.6954],
[8.31718, 12.18408, 2.6954],
[8.20835, 12.39948, 2.6954],
[8.2597, 12.60107, 2.6954],
[8.50184, 12.72947, 2.6954],
[8.51803, 12.91868, 2.6954],
[8.67676, 13.07052, 2.6954],
[8.32359, 13.39747, 2.6954],
[8.63593, 13.43729, 2.6954],
[8.66148, 13.58518, 2.6954],
[8.77075, 13.79291, 2.6954],
[8.96905, 13.8895, 2.6954],
[9.00513, 14.1114, 2.6954],
[8.8294, 14.32799, 2.6954],
[8.8546, 14.55246, 2.6954],
[9.08692, 14.65969, 2.6954],
[8.83112, 14.9578, 2.6954],
[9.39485, 14.91184, 2.6954],
[9.10591, 15.26289, 2.6954],
[9.05297, 15.43064, 2.6954],
[9.0685, 15.59023, 2.6954],
[9.59052, 15.67291, 2.6954],
[9.61126, 15.85105, 2.6954],
[9.26543, 16.11163, 2.6954],
[9.73138, 16.1651, 2.6954],
[9.83719, 16.35614, 2.6954],
[9.76482, 16.59488, 2.6954],
[9.45081, 16.80142, 2.6954],
[9.81785, 16.88121, 2.6954],
[9.8822, 17.09814, 2.6954],
[9.9548, 17.2616, 2.6954],
[10.04501, 17.41974, 2.6954],
[10.04635, 17.59631, 2.6954],
[9.74446, 17.85783, 2.6954],
[9.82256, 18.03337, 2.6954],
[9.83072, 18.21156, 2.6954],
[10.06879, 18.37529, 2.6954],
[9.84359, 18.59208, 2.6954],
[10.02441, 18.7685, 2.6954],
[10.27173, 18.85736, 2.6954],
[9.90457, 19.10873, 2.6954],
[9.89563, 19.32175, 2.6954],
[10.04511, 19.50085, 2.6954],
[10.28407, 19.65071, 2.6954],
[10.24855, 19.82222, 2.6954],
[10.01736, 20.00628, 2.6954],
[10.30878, 20.15822, 2.6954],
[10.179, 20.31056, 2.6954],
[10.07714, 20.54614, 2.6954],
[10.2913, 20.74595, 2.6954],
[10.29389, 20.89513, 2.6954],
[10.50301, 21.03082, 2.6954],
[10.42838, 21.26197, 2.6954],
[10.25429, 21.41946, 2.6954],
[10.57934, 21.63235, 2.6954],
[10.07864, 21.80895, 2.6954],
[10.21196, 21.96058, 2.6954],
[10.31773, 22.13933, 2.6954],
[10.27971, 22.34172, 2.6954],
[10.63653, 22.47639, 2.6954],
[10.12223, 22.6971, 2.6954],
[10.36614, 22.89953, 2.6954],
[10.42741, 23.08153, 2.6954],
[10.19985, 23.22683, 2.6954],
[10.61357, 23.43469, 2.6954],
[10.50699, 23.57301, 2.6954],
[10.25028, 23.81011, 2.6954],
[10.42108, 24.01289, 2.6954],
[10.46949, 24.19706, 2.6954],
[10.63584, 24.34619, 2.6954],
[10.43548, 24.5751, 2.6954],
[10.3185, 24.69607, 2.6954],
[10.39633, 24.89288, 2.6954],
[10.44597, 25.05015, 2.6954],
[10.24516, 25.2295, 2.6954],
[10.33431, 25.43477, 2.6954],
[10.42268, 25.63963, 2.6954],
[10.403, 25.81102, 2.6954],
[10.39172, 25.96036, 2.6954],
[10.56319, 26.21587, 2.6954],
[9.96747, 26.29702, 2.6954],
[10.10922, 26.48312, 2.6954],
[10.28043, 26.70934, 2.6954],
[10.01246, 26.83618, 2.6954],
[10.22057, 27.02802, 2.6954],
[9.87846, 27.22605, 2.6954],
[10.10007, 27.42894, 2.6954],
[9.97082, 27.60521, 2.6954],
[10.02185, 27.78041, 2.6954],
[10.27611, 28.03579, 2.6954],
[10.16572, 28.16306, 2.6954],
[10.02821, 28.32161, 2.6954],
[10.23758, 28.54468, 2.6954],
[10.09376, 28.74017, 2.6954],
[9.84914, 28.82303, 2.6954],
[9.80151, 29.0155, 2.6954],
[9.71404, 29.17376, 2.6954],
[9.58705, 29.29373, 2.6954],
[9.74396, 29.57387, 2.6954],
[9.78724, 29.79564, 2.6954],
[9.43758, 29.82291, 2.6954],
[9.61783, 30.08814, 2.6954],
[9.49842, 30.24345, 2.6954],
[9.33962, 30.43388, 2.6954],
[9.77467, 30.70943, 2.6954],
[9.27707, 30.7644, 2.6954],
[9.50111, 30.98178, 2.6954],
[9.30563, 31.11515, 2.6954],
[9.13336, 31.26478, 2.6954],
[9.29052, 31.48475, 2.6954],
[9.12335, 31.5957, 2.6954],
[8.93094, 31.78347, 2.6954],
[9.23123, 32.02066, 2.6954],
[8.84841, 32.12062, 2.6954],
[9.1253, 32.41783, 2.6954],
[8.77154, 32.50293, 2.6954],
[8.97197, 32.74367, 2.6954],
[9.01159, 32.98041, 2.6954],
[8.47888, 32.94924, 2.6954],
[8.96638, 33.33022, 2.6954],
[8.31888, 33.29604, 2.6954],
[8.4784, 33.48594, 2.6954],
[8.52023, 33.76793, 2.6954],
[8.50483, 33.93692, 2.6954],
[8.20729, 34.01218, 2.6954],
[8.23931, 34.26307, 2.6954],
[8.12397, 34.36815, 2.6954],
[8.29021, 34.60409, 2.6954],
[8.09545, 34.74788, 2.6954],
[8.00378, 34.92554, 2.6954],
[8.03182, 35.1154, 2.6954],
[8.0019, 35.3078, 2.6954],
[7.82942, 35.47416, 2.6954],
[7.64328, 35.57276, 2.6954],
[7.85609, 35.86665, 2.6954],
[7.70124, 36.00883, 2.6954],
[7.27073, 35.95012, 2.6954],
[7.40446, 36.23314, 2.6954],
[7.37414, 36.392, 2.6954],
[7.23125, 36.56025, 2.6954],
[7.39104, 36.79948, 2.6954],
[7.03393, 36.85127, 2.6954],
[7.25134, 37.19354, 2.6954],
[7.08762, 37.27468, 2.6954],
[7.01693, 37.41981, 2.6954],
[6.72363, 37.53348, 2.6954],
[6.3669, 37.55896, 2.6954],
[6.40372, 37.71475, 2.6954],
[6.43485, 37.99445, 2.6954],
[6.55659, 38.22973, 2.6954],
[6.02005, 38.13854, 2.6954],
[6.12184, 38.44553, 2.6954],
[6.02006, 38.6028, 2.6954],
[6.1646, 38.82591, 2.6954],
[5.86475, 38.93753, 2.6954],
[5.63129, 38.93694, 2.6954],
[5.814, 39.35437, 2.6954],
[5.80132, 39.54123, 2.6954],
[5.61574, 39.59116, 2.6954],
[5.58548, 39.81653, 2.6954],
[5.225, 39.77198, 2.6954],
[5.16537, 39.95106, 2.6954],
[4.89727, 39.99975, 2.6954],
[5.15413, 40.41468, 2.6954],
[4.73409, 40.33237, 2.6954],
[4.79412, 40.59828, 2.6954],
[4.54825, 40.65656, 2.6954],
[4.72847, 40.98632, 2.6954],
[4.46188, 40.99014, 2.6954],
[4.34568, 41.19984, 2.6954],
[4.21221, 41.34577, 2.6954],
[4.15364, 41.48377, 2.6954],
[4.0109, 41.59267, 2.6954],
[4.0611, 41.87798, 2.6954],
[3.66166, 41.74063, 2.6954],
[3.44491, 41.87517, 2.6954],
[3.68852, 42.24656, 2.6954],
[3.59352, 42.43641, 2.6954],
[3.53186, 42.60404, 2.6954],
[3.1505, 42.5446, 2.6954],
[2.87205, 42.51878, 2.6954],
[2.73775, 42.6603, 2.6954],
[2.59445, 42.78998, 2.6954],
[2.56275, 43.04578, 2.6954],
[2.60386, 43.22994, 2.6954],
[2.5379, 43.52104, 2.6954],
[2.27372, 43.47783, 2.6954],
[2.09954, 43.54439, 2.6954],
[2.21888, 43.96038, 2.6954],
[2.08726, 44.05534, 2.6954],
[1.77119, 44.03189, 2.6954],
[1.59574, 44.12822, 2.6954],
[1.69597, 44.48955, 2.6954],
[1.5621, 44.55156, 2.6954],
[1.23826, 44.51048, 2.6954],
[0.96843, 44.42778, 2.6954],
[0.97381, 44.78267, 2.6954],
[1.08561, 45.11837, 2.6954]])

n_samples = 360

nist_cir_data_2 = np.array([[-605.26558,-259.31783,381.29524],
[-608.22122,-259.42663,381.29524],
[-611.17451,-259.58701,381.29524],
[-614.12455,-259.7989,381.29524],
[-617.07044,-260.06224,381.29524],
[-620.01128,-260.37696,381.29524],
[-622.94619,-260.74295,381.29524],
[-625.87426,-261.16011,381.29524],
[-628.79461,-261.62831,381.29524],
[-631.70634,-262.14741,381.29524],
[-634.60856,-262.71724,381.29524],
[-637.5004,-263.33763,381.29524],
[-640.38097,-264.0084,381.29524],
[-643.2494,-264.72934,381.29524],
[-646.10481,-265.50023,381.29524],
[-648.94633,-266.32084,381.29524],
[-651.77309,-267.19092,381.29524],
[-654.58424,-268.11019,381.29524],
[-657.37892,-269.07839,381.29524],
[-660.15627,-270.09522,381.29524],
[-662.91546,-271.16036,381.29524],
[-665.65563,-272.27349,381.29524],
[-668.37596,-273.43427,381.29524],
[-671.07562,-274.64236,381.29524],
[-673.75379,-275.89738,381.29524],
[-676.40964,-277.19894,381.29524],
[-679.04237,-278.54666,381.29524],
[-681.65118,-279.94012,381.29524],
[-684.23528,-281.3789,381.29524],
[-686.79387,-282.86256,381.29524],
[-689.32617,-284.39065,381.29524],
[-691.83143,-285.96269,381.29524],
[-694.30886,-287.57823,381.29524],
[-696.75772,-289.23675,381.29524],
[-699.17727,-290.93776,381.29524],
[-701.56676,-292.68073,381.29524],
[-703.92547,-294.46515,381.29524],
[-706.25267,-296.29045,381.29524],
[-708.54766,-298.1561,381.29524],
[-710.80975,-300.06151,381.29524],
[-713.03824,-302.00611,381.29524],
[-715.23245,-303.98931,381.29524],
[-717.39171,-306.0105,381.29524],
[-719.51537,-308.06906,381.29524],
[-721.60278,-310.16438,381.29524],
[-723.6533,-312.29581,381.29524],
[-725.66631,-314.4627,381.29524],
[-727.6412,-316.66439,381.29524],
[-729.57736,-318.90021,381.29524],
[-731.47421,-321.16948,381.29524],
[-733.33117,-323.47151,381.29524],
[-735.14766,-325.8056,381.29524],
[-736.92314,-328.17104,381.29524],
[-738.65707,-330.5671,381.29524],
[-740.34892,-332.99306,381.29524],
[-741.99818,-335.44817,381.29524],
[-743.60433,-337.9317,381.29524],
[-745.1669,-340.44288,381.29524],
[-746.6854,-342.98094,381.29524],
[-748.15937,-345.54512,381.29524],
[-749.58837,-348.13464,381.29524],
[-750.97196,-350.7487,381.29524],
[-752.30972,-353.38651,381.29524],
[-753.60123,-356.04726,381.29524],
[-754.84612,-358.73015,381.29524],
[-756.04399,-361.43436,381.29524],
[-757.19448,-364.15906,381.29524],
[-758.29724,-366.90342,381.29524],
[-759.35195,-369.66661,381.29524],
[-760.35826,-372.44779,381.29524],
[-761.31589,-375.24611,381.29524],
[-762.22453,-378.06071,381.29524],
[-763.08391,-380.89075,381.29524],
[-763.89377,-383.73535,381.29524],
[-764.65386,-386.59365,381.29524],
[-765.36396,-389.46478,381.29524],
[-766.02383,-392.34787,381.29524],
[-766.63329,-395.24203,381.29524],
[-767.19214,-398.14639,381.29524],
[-767.70023,-401.06006,381.29524],
[-768.15738,-403.98216,381.29524],
[-768.56347,-406.91179,381.29524],
[-768.91836,-409.84806,381.29524],
[-769.22196,-412.79007,381.29524],
[-769.47416,-415.73694,381.29524],
[-769.6749,-418.68776,381.29524],
[-769.82411,-421.64163,381.29524],
[-769.92174,-424.59766,381.29524],
[-769.96777,-427.55494,381.29524],
[-769.96218,-430.51257,381.29524],
[-769.90497,-433.46966,381.29524],
[-769.79616,-436.42529,381.29524],
[-769.63579,-439.37858,381.29524],
[-769.4239,-442.32862,381.29524],
[-769.16055,-445.27451,381.29524],
[-768.84584,-448.21536,381.29524],
[-768.47984,-451.15026,381.29524],
[-768.06268,-454.07833,381.29524],
[-767.59449,-456.99868,381.29524],
[-767.07539,-459.91041,381.29524],
[-766.50556,-462.81264,381.29524],
[-765.88517,-465.70448,381.29524],
[-765.2144,-468.58505,381.29524],
[-764.49345,-471.45347,381.29524],
[-763.72256,-474.30888,381.29524],
[-762.90195,-477.1504,381.29524],
[-762.03188,-479.97716,381.29524],
[-761.1126,-482.78831,381.29524],
[-760.14441,-485.58299,381.29524],
[-759.12758,-488.36035,381.29524],
[-758.06244,-491.11953,381.29524],
[-756.94931,-493.85971,381.29524],
[-755.78852,-496.58004,381.29524],
[-754.58044,-499.2797,381.29524],
[-753.32542,-501.95786,381.29524],
[-752.02386,-504.61371,381.29524],
[-750.67614,-507.24644,381.29524],
[-749.28268,-509.85525,381.29524],
[-747.8439,-512.43935,381.29524],
[-746.36024,-514.99794,381.29524],
[-744.83215,-517.53025,381.29524],
[-743.2601,-520.0355,381.29524],
[-741.64457,-522.51293,381.29524],
[-739.98605,-524.9618,381.29524],
[-738.28504,-527.38134,381.29524],
[-736.54207,-529.77083,381.29524],
[-734.75765,-532.12954,381.29524],
[-732.93235,-534.45674,381.29524],
[-731.0667,-536.75174,381.29524],
[-729.16129,-539.01382,381.29524],
[-727.21669,-541.24231,381.29524],
[-725.23349,-543.43652,381.29524],
[-723.2123,-545.59578,381.29524],
[-721.15373,-547.71944,381.29524],
[-719.05842,-549.80685,381.29524],
[-716.92699,-551.85737,381.29524],
[-714.7601,-553.87039,381.29524],
[-712.55841,-555.84527,381.29524],
[-710.32259,-557.78144,381.29524],
[-708.05332,-559.67828,381.29524],
[-705.75128,-561.53524,381.29524],
[-703.4172,-563.35173,381.29524],
[-701.05176,-565.12722,381.29524],
[-698.6557,-566.86115,381.29524],
[-696.22974,-568.553,381.29524],
[-693.77462,-570.20225,381.29524],
[-691.2911,-571.8084,381.29524],
[-688.77992,-573.37097,381.29524],
[-686.24185,-574.88947,381.29524],
[-683.67767,-576.36345,381.29524],
[-681.08816,-577.79244,381.29524],
[-678.4741,-579.17603,381.29524],
[-675.83629,-580.51379,381.29524],
[-673.17554,-581.80531,381.29524],
[-670.49265,-583.05019,381.29524],
[-667.78844,-584.24806,381.29524],
[-665.06374,-585.39855,381.29524],
[-662.31938,-586.50132,381.29524],
[-659.55618,-587.55602,381.29524],
[-656.77501,-588.56234,381.29524],
[-653.97669,-589.51996,381.29524],
[-651.16208,-590.4286,381.29524],
[-648.33205,-591.28798,381.29524],
[-645.48745,-592.09784,381.29524],
[-642.62915,-592.85794,381.29524],
[-639.75802,-593.56803,381.29524],
[-636.87493,-594.2279,381.29524],
[-633.98076,-594.83736,381.29524],
[-631.0764,-595.39622,381.29524],
[-628.16273,-595.9043,381.29524],
[-625.24064,-596.36145,381.29524],
[-622.31101,-596.76754,381.29524],
[-619.37474,-597.12243,381.29524],
[-616.43273,-597.42603,381.29524],
[-613.48586,-597.67824,381.29524],
[-610.53504,-597.87897,381.29524],
[-607.58117,-598.02818,381.29524],
[-604.62514,-598.12581,381.29524],
[-601.66786,-598.17184,381.29524],
[-598.71023,-598.16625,381.29524],
[-595.75314,-598.10904,381.29524],
[-592.79751,-598.00024,381.29524],
[-589.84422,-597.83986,381.29524],
[-586.89418,-597.62797,381.29524],
[-583.94829,-597.36463,381.29524],
[-581.00744,-597.04991,381.29524],
[-578.07253,-596.68392,381.29524],
[-575.14446,-596.26676,381.29524],
[-572.22412,-595.79856,381.29524],
[-569.31239,-595.27947,381.29524],
[-566.41016,-594.70963,381.29524],
[-563.51832,-594.08924,381.29524],
[-560.63775,-593.41847,381.29524],
[-557.76932,-592.69753,381.29524],
[-554.91392,-591.92664,381.29524],
[-552.0724,-591.10603,381.29524],
[-549.24563,-590.23595,381.29524],
[-546.43448,-589.31668,381.29524],
[-543.63981,-588.34848,381.29524],
[-540.86245,-587.33166,381.29524],
[-538.10327,-586.26651,381.29524],
[-535.36309,-585.15338,381.29524],
[-532.64276,-583.9926,381.29524],
[-529.9431,-582.78451,381.29524],
[-527.26494,-581.52949,381.29524],
[-524.60909,-580.22793,381.29524],
[-521.97635,-578.88021,381.29524],
[-519.36754,-577.48675,381.29524],
[-516.78345,-576.04797,381.29524],
[-514.22486,-574.56431,381.29524],
[-511.69255,-573.03622,381.29524],
[-509.1873,-571.46418,381.29524],
[-506.70986,-569.84865,381.29524],
[-504.261,-568.19012,381.29524],
[-501.84146,-566.48911,381.29524],
[-499.45197,-564.74614,381.29524],
[-497.09326,-562.96172,381.29524],
[-494.76605,-561.13642,381.29524],
[-492.47106,-559.27077,381.29524],
[-490.20897,-557.36536,381.29524],
[-487.98049,-555.42076,381.29524],
[-485.78628,-553.43756,381.29524],
[-483.62702,-551.41637,381.29524],
[-481.50336,-549.35781,381.29524],
[-479.41595,-547.26249,381.29524],
[-477.36542,-545.13106,381.29524],
[-475.35241,-542.96417,381.29524],
[-473.37752,-540.76248,381.29524],
[-471.44136,-538.52666,381.29524],
[-469.54451,-536.25739,381.29524],
[-467.68756,-533.95536,381.29524],
[-465.87106,-531.62127,381.29524],
[-464.09558,-529.25583,381.29524],
[-462.36165,-526.85977,381.29524],
[-460.6698,-524.43381,381.29524],
[-459.02055,-521.9787,381.29524],
[-457.41439,-519.49517,381.29524],
[-455.85183,-516.98399,381.29524],
[-454.33333,-514.44593,381.29524],
[-452.85935,-511.88175,381.29524],
[-451.43035,-509.29223,381.29524],
[-450.04676,-506.67817,381.29524],
[-448.70901,-504.04036,381.29524],
[-447.41749,-501.37961,381.29524],
[-446.17261,-498.69672,381.29524],
[-444.97474,-495.99251,381.29524],
[-443.82425,-493.26781,381.29524],
[-442.72148,-490.52345,381.29524],
[-441.66678,-487.76026,381.29524],
[-440.66046,-484.97908,381.29524],
[-439.70284,-482.18076,381.29524],
[-438.79419,-479.36616,381.29524],
[-437.93481,-476.53612,381.29524],
[-437.12495,-473.69152,381.29524],
[-436.36486,-470.83322,381.29524],
[-435.65477,-467.96209,381.29524],
[-434.99489,-465.079,381.29524],
[-434.38544,-462.18484,381.29524],
[-433.82658,-459.28048,381.29524],
[-433.3185,-456.36681,381.29524],
[-432.86135,-453.44471,381.29524],
[-432.45526,-450.51508,381.29524],
[-432.10036,-447.57881,381.29524],
[-431.79677,-444.6368,381.29524],
[-431.54456,-441.68993,381.29524],
[-431.34382,-438.73911,381.29524],
[-431.19462,-435.78524,381.29524],
[-431.09698,-432.82921,381.29524],
[-431.05096,-429.87193,381.29524],
[-431.05655,-426.9143,381.29524],
[-431.11375,-423.95722,381.29524],
[-431.22256,-421.00158,381.29524],
[-431.38294,-418.04829,381.29524],
[-431.59483,-415.09825,381.29524],
[-431.85817,-412.15236,381.29524],
[-432.17289,-409.21151,381.29524],
[-432.53888,-406.27661,381.29524],
[-432.95604,-403.34854,381.29524],
[-433.42424,-400.42819,381.29524],
[-433.94333,-397.51646,381.29524],
[-434.51316,-394.61423,381.29524],
[-435.13356,-391.72239,381.29524],
[-435.80433,-388.84182,381.29524],
[-436.52527,-385.9734,381.29524],
[-437.29616,-383.11799,381.29524],
[-438.11677,-380.27647,381.29524],
[-438.98684,-377.44971,381.29524],
[-439.90612,-374.63856,381.29524],
[-440.87432,-371.84388,381.29524],
[-441.89114,-369.06653,381.29524],
[-442.95628,-366.30734,381.29524],
[-444.06942,-363.56716,381.29524],
[-445.2302,-360.84683,381.29524],
[-446.43829,-358.14717,381.29524],
[-447.6933,-355.46901,381.29524],
[-448.99487,-352.81316,381.29524],
[-450.34259,-350.18043,381.29524],
[-451.73605,-347.57162,381.29524],
[-453.17483,-344.98752,381.29524],
[-454.65849,-342.42893,381.29524],
[-456.18657,-339.89662,381.29524],
[-457.75862,-337.39137,381.29524],
[-459.37415,-334.91394,381.29524],
[-461.03267,-332.46507,381.29524],
[-462.73368,-330.04553,381.29524],
[-464.47666,-327.65604,381.29524],
[-466.26107,-325.29733,381.29524],
[-468.08638,-322.97013,381.29524],
[-469.95202,-320.67513,381.29524],
[-471.85744,-318.41305,381.29524],
[-473.80204,-316.18456,381.29524],
[-475.78524,-313.99035,381.29524],
[-477.80643,-311.83109,381.29524],
[-479.86499,-309.70743,381.29524],
[-481.96031,-307.62002,381.29524],
[-484.09173,-305.5695,381.29524],
[-486.25862,-303.55648,381.29524],
[-488.46031,-301.5816,381.29524],
[-490.69614,-299.64543,381.29524],
[-492.96541,-297.74859,381.29524],
[-495.26744,-295.89163,381.29524],
[-497.60153,-294.07514,381.29524],
[-499.96696,-292.29965,381.29524],
[-502.36303,-290.56572,381.29524],
[-504.78898,-288.87387,381.29524],
[-507.2441,-287.22462,381.29524],
[-509.72763,-285.61847,381.29524],
[-512.2388,-284.0559,381.29524],
[-514.77687,-282.5374,381.29524],
[-517.34105,-281.06342,381.29524],
[-519.93057,-279.63443,381.29524],
[-522.54463,-278.25084,381.29524],
[-525.18243,-276.91308,381.29524],
[-527.84319,-275.62156,381.29524],
[-530.52608,-274.37668,381.29524],
[-533.23028,-273.17881,381.29524],
[-535.95498,-272.02832,381.29524],
[-538.69935,-270.92555,381.29524],
[-541.46254,-269.87085,381.29524],
[-544.24372,-268.86453,381.29524],
[-547.04204,-267.90691,381.29524],
[-549.85664,-266.99827,381.29524],
[-552.68667,-266.13889,381.29524],
[-555.53128,-265.32903,381.29524],
[-558.38958,-264.56893,381.29524],
[-561.26071,-263.85884,381.29524],
[-564.1438,-263.19897,381.29524],
[-567.03796,-262.58951,381.29524],
[-569.94232,-262.03065,381.29524],
[-572.85599,-261.52257,381.29524],
[-575.77809,-261.06542,381.29524],
[-578.70771,-260.65933,381.29524],
[-581.64398,-260.30444,381.29524],
[-584.586,-260.00084,381.29524],
[-587.53286,-259.74863,381.29524],
[-590.48368,-259.5479,381.29524],
[-593.43756,-259.39869,381.29524],
[-596.39358,-259.30106,381.29524],
[-599.35086,-259.25503,381.29524],
[-602.3085,-259.26062,381.29524]])

xy_nist_data = nist_cir_data_2[:, :2]
xc,yc,r,_ = cf.least_squares_circle(xy_nist_data)
print(f"Least squares circle: ({xc}, {yc}) radius = {r}")
centered_points = xy_nist_data - np.array([xc, yc])
polar_nist_data = cartesian_to_polar(centered_points)
radius_nist_data = polar_nist_data[:, :1]
#print(radius_nist_data)
np_fft = np.fft.rfft(radius_nist_data.flatten())
amplitudes = np.abs(np_fft) * (1 / n_samples)
for i in range(0, 10):
    print(amplitudes[i])
frequencies = np.fft.fftfreq(n_samples) * n_samples * 1
#for i in range(0, (int(polar_nist_data.size / 2)) - 1):
#    plt.polar(polar_nist_data[i][1], polar_nist_data[i][0],'k.')
plt.plot(frequencies[:len(frequencies) // 2], amplitudes[:len(np_fft) - 1])
plt.show()
# print(amplitudes)
